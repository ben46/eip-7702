# EIP-7702 ่ตๅฉไบคๆ - Hardhat็ๆฌ

่ฟๆฏEIP-7702่ตๅฉไบคๆๅ่ฝ็Hardhatๆต่ฏๅฎ็ฐ๏ผไปFoundry็ๆฌ่ฝฌๆข่ๆฅใ

## ๐ ้กน็ฎ็ปๆ

```
hardhat-version/
โโโ contracts/                 # ๆบ่ฝๅ็บฆ
โ   โโโ BatchCallAndSponsor.sol
โ   โโโ MockERC20.sol
โโโ test/                      # ๆต่ฏๆไปถ
โ   โโโ SponsoredERC20Transfer.test.js
โโโ hardhat.config.js          # Hardhat้็ฝฎ
โโโ package.json               # ไพ่ต็ฎก็
โโโ README.md                  # ๆฌๆๆกฃ
```

## ๐ ๅฟซ้ๅผๅง

### 1. ๅฎ่ฃไพ่ต

```bash
cd hardhat-version
npm install
```

### 2. ็ผ่ฏๅ็บฆ

```bash
npm run compile
```

### 3. ่ฟ่กๆต่ฏ

```bash
# ่ฟ่กๅบ็กๆต่ฏ
npm test

# ่ฟ่กๅธฆgasๆฅๅ็ๆต่ฏ
npm run test:gas
```

## ๐ฏ ไธป่ฆ็นๆง

### Gas้็ฝฎ
- **Gasไปทๆผ**: 20 gwei (ๆจกๆ็ๅฎ็ฝ็ป)
- **ๅบๅGas้ๅถ**: 30M gas
- **ๅบ็ก่ดน็จ**: 7 wei

### ่ดฆๆท้็ฝฎ
- **Alice**: `0x70997970C51812dc3A010C7d01b50e0d17dc79C8` (10 ETH)
- **Bob**: `0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC` (5 ETH)
- **Charlie**: ๅจๆ็ๆ็ๆต่ฏๅฐๅ

## ๐ ๆต่ฏ็จไพ

### 1. ๅบ็ก่ตๅฉ่ฝฌ่ดฆๆต่ฏ
- Alice่ฝฌ่ดฆ100ไธชไปฃๅธ็ปCharlie
- ไบคๆ็ฑBob่ตๅฉๅๅ้
- ้ช่ฏgasๆถ่ๆบๅถ

### 2. ๆๆ็ญพๅๆต่ฏ
- ไฝฟ็จ้่ฏฏ็็ญพๅ่ฟ่ก่ฝฌ่ดฆ
- ้ช่ฏไบคๆๆญฃ็กฎๅๆป

### 3. ไฝ้ขไธ่ถณๆต่ฏ
- ๅฐ่ฏ่ฝฌ่ดฆ่ถ่ฟไฝ้ข็ไปฃๅธ
- ้ช่ฏไบคๆๆญฃ็กฎๅคฑ่ดฅ

## ๐ง ้็ฝฎ่ฏดๆ

### Hardhat้็ฝฎ (`hardhat.config.js`)

```javascript
module.exports = {
  solidity: {
    version: "0.8.25",
    settings: {
      optimizer: { enabled: true, runs: 200 },
      evmVersion: "prague", // ๆฏๆEIP-7702
      viaIR: true
    },
  },
  networks: {
    hardhat: {
      gasPrice: 20000000000, // 20 gwei
      blockGasLimit: 30000000, // 30M gas
      initialBaseFeePerGas: 7, // 7 wei
    },
  }
};
```

## โ๏ธ ้่ฆ่ฏดๆ

### EIP-7702ๆจกๆ้ๅถ
็ฑไบHardhat็ฎๅ่ฟไธๅฎๅจๆฏๆEIP-7702๏ผ่ฟไธชๅฎ็ฐไฝฟ็จไบไธไบworkaroundๆฅๆจกๆๅงๆๅ่ฝ๏ผ

1. **ๅงๆๆจกๆ**: ้่ฟ้จ็ฝฒๅ็บฆๅฐ็นๅฎๅฐๅๆฅๆจกๆ่ดฆๆทไปฃ็ๅงๆ
2. **Gasๆถ่**: ๆจกๆไบ่ตๅฉไบคๆ็gasๆบๅถ
3. **็ญพๅ้ช่ฏ**: ๅฎ็ฐไบไธEIP-7702็ธๅ็็ญพๅ้ช่ฏ้ป่พ

### ไธFoundry็ๆฌ็ๅทฎๅผ
- **ๆต่ฏๆกๆถ**: ไฝฟ็จMocha/Chai่ไธๆฏForge
- **Gas่ท่ธช**: ไฝฟ็จethers.js็gasไผฐ็ฎๅ่ท่ธช
- **่ดฆๆท็ฎก็**: ไฝฟ็จHardhat็่ดฆๆท็ณป็ป

## ๐ ็คบไพ่พๅบ

```
=== ๆต่ฏ่ตๅฉ็ERC-20่ฝฌ่ดฆ ===
Alice่ฝฌ่ดฆ100ไธชไปฃๅธ็ปCharlie๏ผไบคๆ็ฑBob่ตๅฉๅๅ้

่ฝฌ่ดฆๅไฝ้ข:
Aliceไปฃๅธ: 1000.0
Charlieไปฃๅธ: 0.0
Alice ETH (gas): 11.0
Bob ETH (gas): 4.998...

็ญพๅไฟกๆฏ:
ๅฝๅnonce: 0
ๆ่ฆ: 0x...
็ญพๅ: 0x...

ไบคๆๅๅธ: 0x...
ๅฎ้gasไฝฟ็จ้: 61651
Gasไปทๆผ: 20.0 gwei
ๆปgas่ดน็จ: 0.00123302 ETH

่ฝฌ่ดฆๅไฝ้ข:
Aliceไปฃๅธ: 900.0
Charlieไปฃๅธ: 100.0

โ ่ตๅฉERC-20่ฝฌ่ดฆๆต่ฏ้่ฟ!
```

## ๐ Gasๅๆ

้่ฟ `npm run test:gas` ๅฏไปฅ่ทๅพ่ฏฆ็ป็gasไฝฟ็จๆฅๅ๏ผ

```
ยท-----------------------------------------|---------------------------|-------------|-----------------------------ยท
|           Solc version: 0.8.25         ยท  Optimizer enabled: true  ยท  Runs: 200  ยท  Block limit: 30000000 gas โ
ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
|  Methods                                                                                                         โ
ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยท
|  Contract              ยท  Method        ยท  Min        ยท  Max        ยท  Avg        ยท  # calls      ยท  usd (avg)  โ
ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยท
|  BatchCallAndSponsor   ยท  execute       ยท      61651  ยท      85432  ยท      73541  ยท            4  ยท          -  โ
ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท|ยทยทยทยทยทยทยทยทยทยทยทยทยทยท
```

## ๐๏ธ ๆฉๅฑๅ่ฝ

### ๆทปๅๆฐๆต่ฏ
ๅจ `test/` ็ฎๅฝไธๅๅปบๆฐ็ๆต่ฏๆไปถ๏ผ

```javascript
describe("ๆฐๅ่ฝๆต่ฏ", function () {
  it("ๅบ่ฏฅ...", async function () {
    // ๆต่ฏ้ป่พ
  });
});
```

### ไฟฎๆนGas้็ฝฎ
ๅจ `hardhat.config.js` ไธญ่ฐๆดgasๅๆฐ๏ผ

```javascript
networks: {
  hardhat: {
    gasPrice: 50000000000, // 50 gwei - ้ซgasไปทๆผๅบๆฏ
    blockGasLimit: 15000000, // 15M gas - ่พๅฐ็ๅบๅ
  }
}
```

## ๐ ็ธๅณ่ตๆบ

- [EIP-7702่ง่](https://eips.ethereum.org/EIPS/eip-7702)
- [Hardhatๆๆกฃ](https://hardhat.org/docs)
- [ethers.jsๆๆกฃ](https://docs.ethers.org/)
- [OpenZeppelinๅ็บฆ](https://docs.openzeppelin.com/contracts/)

## ๐ค ่ดก็ฎ

ๆฌข่ฟๆไบคissuesๅpull requestsๆฅๆน่ฟ่ฟไธชๅฎ็ฐ๏ผ
